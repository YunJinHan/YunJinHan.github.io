<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>JinHan's Blog | Angular2 Service2 </title>
  <meta name="theme-color" content="#222222" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="/js/jquery.min.js"></script>
  <script src="/js/bootstrap.min.js"></script>
  <script src="/js/header.js"></script>
  <script src="/js/toc.js"></script>
  <link rel="icon" href="/favicon.png" type="image/x-icon">
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/theme.css" rel="stylesheet">
  <link href="/css/syntax.css" rel="stylesheet">
  <link href="/css/font-awesome/css/font-awesome.min.css" rel="stylesheet">
</head>

<body>

  

  


 <script type="text/javascript">
  WebFontConfig = {
    google: {
      families: ['Ubuntu::latin']
    }
  };
  (function() {
    var wf = document.createElement('script');
    wf.src = ('https:' == document.location.protocol ? 'https' : 'http') +
      '://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js';
    wf.type = 'text/javascript';
    wf.async = 'true';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(wf, s);
  })();
</script>

  <nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="/">JinHan's Blog</a>
      </div>
      <div class="collapse navbar-collapse">
        <ul class="nav navbar-nav">
          <li><a href="/">/home</a></li>
          <li><a href="/archive.html">/archive</a></li>
          <li><a href="/tags.html">/tags</a></li>
          <li><a href="/about.html">/about</a></li>
        </ul>
      </div>
    </div>
  </nav>

    <div class="wrapper">
      <div class="content">
        <div class="container container-center">
          <div class="row">
            <div class="col-md-8">
              <div class="article">
                <div class="well">
                  <h1><a href="/2017/04/Angular2-Service2">Angular2 Service2</a></h1>
                  <div class="post-meta">
                    <div class="post-time">
                      <i class="fa fa-calendar"></i>
                      <time>30 Apr 2017</time>
                    </div>
                    <ul>
                      
                        <li><a href="/tag/Angular2">Angular2</a></li>
                      
                    </ul>
                  </div>
                  <div class="post-content">
                    <div id="toc" class="toc"></div>
                    <h1 id="angular2-service2">Angular2 Service2</h1>

<h3 id="--promise-서비스">- Promise 서비스</h3>
<p>promise 는 비동기 코드를 사용할 때 Call Back Hell 과 같은 비정상적인 호출 형태를 개선하기 이해 나온 방법이다.</p>

<pre>
export class User {
  name: string;
  id: string;
}
</pre>

<p>===&gt; user.ts</p>

<pre>
import { User } from './user';

export var USERS: User[] = [
  { name: '조조', id: '1' },
  { name: '하우돈', id: '2' },
  { name: '허저', id: '3' }
];
</pre>

<p>===&gt; mock-user.ts</p>

<pre>
import { Injectable } from '@angular/core';
import { USERS } from './mock-user';
import { User } from './user';

@Injectable()
export class MockService {
  getUser(): Promise&lt; User[]&gt; {
    return Promise.resolve(USERS);
  }

  getUserDelay(): Promise&lt; User[]&gt; {
    return new Promise&lt; User[]&gt;(resolve =&gt;
      setTimeout(resolve, 1000))
      .then(() =&gt; this.getUser());
  }
  
  getRequest(status: boolean): Promise&lt; any&gt; {

    if (status) {
      return Promise.resolve("요청을 승낙합니다.").then(function (reason) {
        return reason;
      }, function (reason) {
        return "NO";
      });
    } else {
      return Promise.reject("요청을 거부합니다.").then(function (reason) {
        return "YES";
      }, function (reason) {
        return reason;
      });
    }
  }
}
</pre>

<p>===&gt; mock.service.ts<br /><strong>Promise.resolve()</strong> 를 통하여 “요청을 승낙합니다” 를 리턴하고<br /><strong>Promise.reject()</strong> 를 통하여 “요청을 거부합니다” 를 리턴한다.</p>

<p><strong>getUser()</strong> 는 mock-user.ts 의 USERS 객체를 리턴한다.<br /><br />
<strong>getUserDelay()</strong> 를 통하여 1초 후 <strong>getUser()</strong> 를 호출한다.</p>

<pre>
import { Component } from '@angular/core';
import { MockService } from './mock.service';
import { User } from './user';

@Component({
  selector: 'promise',
  template: `
  &lt; br&gt;
  &lt; br&gt;  
  &lt; list-component [list]="listUser" [title]="'이름 출력 (지연없음)'"&gt;&lt; /list-component&gt;
  &lt; list-component [list]="listUserDelay" [title]="'이름 출력 (1초 지연)'"&gt;&lt; /list-component&gt;`,
  providers: [MockService]
})
export class PromiseComponent {
  reqMessage: String ='';
  reqMessage2: String ='';

  listUser: User[];
  listUserDelay: User[];
  
  constructor(private userService: MockService) {
    this.userService.getRequest(true).then(reason =&gt; this.reqMessage = reason);
    this.userService.getRequest(false).then(reason =&gt; this.reqMessage2 = reason);
    // -&gt; reason 을 리턴받아 =&gt; this.regMessage 에 할당한다.

    this.userService.getUser().then(user =&gt; this.listUser = user);
    this.userService.getUserDelay().then(user =&gt; this.listUserDelay = user);
  	// -&gt; user 를 리턴받아 =&gt; this.listUser 에 할당한다.
  }
}
</pre>

<p>===&gt; promise.component.ts<br />생성자 부분에서 mock.service 를 선언하고 해당 서비스를 사용하여 값을 받아와<br />자식 컴포넌트 list-component 로 title 과 list 값을 전달한다.</p>

<pre>
import { Component, Input } from '@angular/core';
import { User } from './user';

@Component({
  selector: 'list-component',
  template: `
  &lt; b&gt;&lt; /b&gt;
  &lt; div *ngFor="let o of list"&gt;
       | 
  &lt; /div&gt;&lt; br&gt;`,
})
export class ListComponent {
  @Input() title: string;
  @Input() list: User;
}
</pre>

<p>===&gt; list.component.ts / 부모로 부터 받은 title 과 list 를 출력한다.</p>

<h3 id="--shared-서비스">- Shared 서비스</h3>
<p>서비스는 컴포넌트 간 상호작용을 위한 매개자로 두 컴포넌트 간에 데이터를 교환하는 중간 매개자로 이용될 수 있다. <strong>@Input 이나 EventEmitter 를 사용하지 않고 데이터를 교환하려면 부모 / 자식 컴포넌트 관계를 가져야 한다.</strong></p>

<ol>
  <li>부모 컴포넌트에 제공자 설정을 통해 주입을 한다.</li>
  <li>자식 컴포넌트에서는 제공자 설정을 하지 않고 곧바로 서비스를 받아서 사용한다.</li>
</ol>

<pre>
import { Injectable } from '@angular/core';

@Injectable()
export class SharedService {
  
  num: number;
  
  message: string;
  // -&gt; 현재 실습에서 사용하는 부모 / 자식 컴포넌트 공유 변수
  
  public names: string[] = [];

  addName(data: string) {
    this.names.unshift(data);
    // unshift : names 배열 앞부분에 data 값을 넣는다
  } 
}
</pre>

<p>===&gt; shared.service.ts / 공유 서비스 정의</p>

<pre>
import { Component, Input } from '@angular/core';
import { SharedService } from './shared.service';

@Component({
  selector: 'car-component',
  template: `car 컴포넌트 :  &lt; button (click)="s.message='car'"&gt;선택&lt; /button&gt;`
})
export class CarComponent {
  constructor(public s: SharedService) {
  }
}
</pre>

<p>===&gt; car.component.ts / 자식 컴포넌트</p>

<pre>
import { Component, Input } from '@angular/core';
import { SharedService } from './shared.service';

@Component({
  selector: 'taxi-component',
  template: `taxi 컴포넌트 :  &lt; button (click)="s.message='taxi'"&gt;선택&lt; /button&gt;`
})
export class TaxiComponent {
  constructor(public s: SharedService) {}
}
</pre>

<p>===&gt; taxi.component.ts / 자식 컴포넌트</p>

<pre>
import { Component, Input } from '@angular/core';
import { SharedService } from './shared.service';

@Component({
  selector: 'parent-component',
  template: `
  부모 컴포넌트 :  &lt; button (click)="s.message='parent'"&gt;선택&lt; /button&gt;&lt; br&gt;
  &lt; car-component&gt;&lt; /car-component&gt;&lt; br&gt;
  &lt; taxi-component&gt;&lt; /taxi-component&gt;`,
  providers: [SharedService]
})
export class ParentComponent {
  constructor(public s: SharedService) {
    s.message = "hello";
  }
}
</pre>

<p>===&gt; parent.component.ts / 부모 컴포넌트</p>

<p>두개의 자식 컴포넌트의 생성자에서 SharedService 를 선언하여 s.message 를 불러오고</p>

<p>부모 컴포넌트 생성자에서 SharedService 를 선언하여 처음 s.message 를 hello 로 선언함</p>

<p>이후 자식에서 버튼 클릭시 s.message 가 각각 car / taxi 로 바뀌어 s.message 를 사용하는</p>

<p>parent / car / taxi 컴포넌트에서 해당 값이 실시간으로 바뀐다.</p>

<p><strong>공유 서비스를 통해 공유 값이 바뀐다</strong></p>


                    

<div class="share-bar">
  <ul class="share-buttons">
    

    

    

    

    

    
    <li class="share-envelope">
      <a href="mailto:?&subject=Angular2 Service2&body=Angular2 Service - promise / shared data http://localhost:4000/2017/04/Angular2-Service2" target="_blank" title="Email">
        <span class="fa-stack fa-lg">
          <i class="fa fa-circle-thin fa-stack-2x"></i>
          <i class="fa fa-envelope-o fa-stack-1x"></i>
        </span>
      </a>
    </li>
    

  </ul>
</div>


                  </div>
                  
                  <div id="disqus_thread">
                    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
                  </div>
                  
                </div>
              </div>
            </div>
            <div class="col-md-4 hidden-xs">
              <div class="sidebar ">
  <h2>Recent Posts</h2>
  <ul>
    
    <li><a href="/2017/04/Angular2-Service2">Angular2 Service2</a></li>
    
    <li><a href="/2017/04/Angular2-Service">Angular2 Service1</a></li>
    
    <li><a href="/2017/04/Angular2-Component2">Angular2 Component2</a></li>
    
    <li><a href="/2017/04/UP-Development-2.-Elaboration">UP Development - 2.Elaboration</a></li>
    
    <li><a href="/2017/04/UP-Development-1.-Inception-3">UP Development - 1.Inception (Cont'd) 2</a></li>
    
    <li><a href="/2017/04/blocked-sort-based-indexing">Index Construction</a></li>
    
    <li><a href="/2017/04/n-gram-overlap">N - Gram Overlap</a></li>
    
    <li><a href="/2017/04/Angular2-Component1">Angular2 Component1</a></li>
    
    <li><a href="/2017/04/UP-Development-1.-Inception-2">UP Development - 1.Inception (Cont'd)</a></li>
    
    <li><a href="/2017/04/spelling-correction">Spelling Correction</a></li>
    
  </ul>
</div>

<div class="sidebar">
  <h2>tags</h2>
  <ul class="sideBarTags">
    
    
    <li>
      <a href="/tag/Angular2" data-toggle="tooltip" data-placement="right" title="5">
        <span>Angular2</span></a></li>
    
    <li>
      <a href="/tag/Information_Retrieval" data-toggle="tooltip" data-placement="right" title="11">
        <span>Information_Retrieval</span></a></li>
    
    <li>
      <a href="/tag/Object-Oriented-Programming" data-toggle="tooltip" data-placement="right" title="11">
        <span>Object-Oriented-Programming</span></a></li>
    
    <li>
      <a href="/tag/Problems" data-toggle="tooltip" data-placement="right" title="3">
        <span>Problems</span></a></li>
    
  </ul>
</div>

            </div>
          </div>
        </div>
        
<script id="dsq-count-scr" src="//https-yunjinhan-github-io.disqus.com/count.js" async></script>
<div id="disqus_thread"></div>
<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://https-yunjinhan-github-io.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                                


      </div>
          <footer class="footer-distributed">
      <div class="container">
        <div class="footer">
          <p>JinHan Yun &copy; 2017</p>
          <h6>Contact Me</h6>

<ul class="social-media">

  
    <li>
      <a title="YunJinHan on Github" href="https://github.com/YunJinHan" target="_blank"><i class="fa fa-github fa-2x"></i></a>
    </li>
  

  
    <li>
      <a title="yjh9234@gmail.com on Email" href="mailto:yjh9234@gmail.com" target=""><i class="fa fa-envelope fa-2x"></i></a>
    </li>
  

</ul>

        </div>
      </div>
    </footer>

    </div>
  </body>
</html>
